# Руководство по административной панели управления зданиями

## Обзор функциональности

Административная панель позволяет администраторам и менеджерам управлять справочником зданий, включая:

1. Просмотр списка всех зданий с фильтрацией и пагинацией
2. Добавление новых зданий
3. Редактирование существующих зданий
4. Деактивация зданий (soft delete)

## Доступ к панели

Панель доступна по адресу: `/admin/buildings`

Доступ имеют только пользователи с ролями:
- ADMIN
- MANAGER

## Функции панели

### 1. Фильтрация зданий

Доступны следующие фильтры:
- Поиск по адресу (улица, номер дома)
- Фильтр по району
- Фильтр по году постройки
- Фильтр по материалу стен
- Фильтр по этажности
- Фильтр по планировке

### 2. Пагинация

Результаты отображаются по 20 записей на странице с возможностью перехода между страницами.

### 3. Добавление/редактирование зданий

При добавлении/редактировании зданий можно указать:
- Район (обязательное поле)
- Улицу (обязательное поле)
- Номер дома (обязательное поле)
- Год постройки
- Материал стен
- Этажность
- Планировка
- Наличие лифта

### 4. Деактивация зданий

Здания можно деактивировать (soft delete), после чего они перестают отображаться в списках и результатах поиска.

## API Endpoints

### Получение списка зданий
```
GET /api/buildings
```

Параметры запроса:
- `page` - номер страницы (по умолчанию 1)
- `limit` - количество записей на странице (по умолчанию 20)
- `districtId` - фильтр по району
- `yearBuilt` - фильтр по году постройки
- `wallMaterial` - фильтр по материалу стен
- `totalFloors` - фильтр по этажности
- `layout` - фильтр по планировке
- `search` - текстовый поиск по адресу

### Создание здания
```
POST /api/buildings
```

Тело запроса:
```json
{
  "districtId": "string",
  "street": "string",
  "houseNumber": "string",
  "yearBuilt": "number",
  "wallMaterial": "string",
  "totalFloors": "number",
  "layout": "string",
  "hasElevator": "boolean"
}
```

### Обновление здания
```
PUT /api/buildings
```

Тело запроса:
```json
{
  "id": "string",
  "districtId": "string",
  "street": "string",
  "houseNumber": "string",
  "yearBuilt": "number",
  "wallMaterial": "string",
  "totalFloors": "number",
  "layout": "string",
  "hasElevator": "boolean"
}
```

### Деактивация здания
```
DELETE /api/buildings?id={buildingId}
```

Параметры запроса:
- `id` - идентификатор здания

## Безопасность

Все API endpoints защищены проверкой прав доступа. Доступ имеют только пользователи с ролями ADMIN и MANAGER.

## Технические детали

### Модель Building в базе данных

После оптимизации схемы Prisma, из модели Building были удалены неиспользуемые поля:
- entranceCount
- buildingType
- layout (дублируется в модели Property)
- heatingType
- latitude/longitude
- dataSource

### Интеграция с PropertyForm

При выборе здания в форме объекта недвижимости автоматически заполняются следующие поля:
- districtId (район)
- yearBuilt (год постройки)
- wallMaterial (материал стен)
- totalFloors (этажность)
- buildingId (идентификатор здания)